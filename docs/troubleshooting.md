# トラブルシューティングガイド

## 音声文字起こしアプリの問題解決

このガイドでは、音声文字起こしアプリケーションを使用する際に発生する可能性のある一般的な問題と、その解決方法を説明します。

## 目次

1. [依存関係のエラー](#依存関係のエラー)
2. [音声分離の問題](#音声分離の問題)
3. [文字起こしの問題](#文字起こしの問題)
4. [パフォーマンスの問題](#パフォーマンスの問題)
5. [ファイル関連の問題](#ファイル関連の問題)

## 依存関係のエラー

### Python依存関係のエラー

アプリケーション起動時に「Python 3.9以上が必要です」や「要件を満たしていません」というメッセージが表示される場合：

1. Pythonがインストールされていることを確認：
   ```bash
   python --version
   ```
   バージョンが3.9以上であることを確認してください。

2. 依存関係を再インストール：
   ```bash
   pip install -r src/python/requirements.txt
   ```

3. 特に環境変数でPythonパスが正しく設定されていることを確認してください。

### Demucsが見つからないエラー

「Demucs が見つかりません」というメッセージが表示される場合：

```bash
pip install demucs
```

### Whisperモデルの問題

モデルが見つからないエラーが発生する場合：

1. faster-whisperモデルをダウンロード：
   ```bash
   python -c "from faster_whisper import download_model; download_model('small')"
   ```

2. OpenAI Whisperモデルをダウンロード：
   ```bash
   python -c "import whisper; whisper.load_model('large-v3')"
   ```

## 音声分離の問題

### TorchとTorchaudioのバージョン不一致エラー

音声分離を有効にすると「音声分離: 無効」と表示される場合や、以下のようなエラーが発生する場合：

```
Symbol not found: __ZN2at4_ops10zeros_like4callERKNS_6TensorEN3c108optionalINS5_10ScalarTypeEEE...
```

これはPyTorchとtorchaudioのバージョン不一致によるエラーです。以下の手順で解決できます：

1. 互換性のあるバージョンをインストール：
   ```bash
   pip uninstall torch torchaudio
   pip install torch==2.2.0 torchaudio==2.2.0
   ```

2. アプリケーションを再起動すると、音声分離機能が正常に動作するようになります。

### 音声分離のパフォーマンス問題

音声分離が遅い場合：

1. より短い音声ファイルで試してください。
2. GPUがある場合、GPUアクセラレーションが有効になっているか確認してください。
3. メモリ不足の場合は、他のアプリケーションを閉じて試してください。

## 文字起こしの問題

### 文字起こし精度の問題

文字起こし結果の精度が低い場合：

1. より大きなモデル（medium, large-v3-turbo）を使用してください。
2. 音声分離を有効にして、背景ノイズを減らしてください。
3. 音声ファイルの品質が良いことを確認してください。
4. 可能であれば、音声入力をクリーンにしてから試してください。

### 文字起こし処理のエラー

文字起こし中にエラーが発生する場合：

1. 音声ファイルが破損していないか確認してください。
2. 別の音声ファイル形式（WAV、MP3など）を試してください。
3. より小さいモデル（faster-whisper small）を選択してみてください。
4. 音声分離を無効にして試してください。

## パフォーマンスの問題

### メモリ使用量の問題

アプリケーションが遅くなったり、クラッシュしたりする場合：

1. 大きな音声ファイルを処理する場合は、より小さなセグメントに分割してみてください。
2. 不要なアプリケーションを閉じて、より多くのメモリを解放してください。
3. より小さなWhisperモデルを使用してみてください。
4. アプリケーションを再起動して、メモリリークの可能性を排除してください。

### 処理速度の問題

処理が非常に遅い場合：

1. より小さなモデル（faster-whisper small）を使用してください。
2. 長い音声ファイルの場合、複数の小さなファイルに分割して処理してください。
3. 音声分離が必要ない場合は無効にしてください。

## ファイル関連の問題

### エクスポートのエラー

エクスポート中にエラーが発生する場合：

1. 保存先のディレクトリに書き込み権限があることを確認してください。
2. 別のファイル形式（.txt、.docx、.srt）を試してください。
3. アプリケーションを再起動してみてください。

### ファイル形式のエラー

サポートされていないファイル形式というエラーが表示される場合：

1. サポートされている形式（MP3、WAV、M4A、FLAC、AAC）のファイルを使用してください。
2. FFmpegを使用して、ファイルを変換してみてください：
   ```bash
   ffmpeg -i input_file.xxx output_file.mp3
   ```

## その他の問題

上記のトラブルシューティング手順で問題が解決しない場合：

1. アプリケーションのログファイルをチェックしてください（`~/Library/Application Support/transcribe2/logs/`）。
2. アプリケーションを完全に再インストールすることを検討してください。
3. プロジェクトのGitHubイシューを確認して、同様の問題がないか探してください。
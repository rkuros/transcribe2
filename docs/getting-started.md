# 音声文字起こしアプリ - 使い方ガイド

## はじめに

この音声文字起こしアプリは、音声ファイルからテキストを生成するためのMac用デスクトップアプリケーションです。Demucsによる音声分離と複数のWhisperモデルを組み合わせて、高品質な文字起こしを提供します。

## インストール

### インストール済みのアプリケーションの場合

1. ダウンロードしたDMGファイルをダブルクリックして開きます。
2. アプリケーションをApplicationsフォルダにドラッグ＆ドロップします。
3. アプリケーションをLaunchpadから起動します。

### ソースコードからのビルド

1. リポジトリをクローンします:
   ```bash
   git clone https://github.com/yourusername/transcribe2.git
   cd transcribe2
   ```

2. Node.js依存関係をインストールします:
   ```bash
   npm install
   ```

3. Python依存関係をインストールします:
   ```bash
   pip install -r src/python/requirements.txt
   ```

4. アプリケーションをビルドしてパッケージ化します:
   ```bash
   npm run package
   ```

5. `release`ディレクトリにあるアプリケーションを起動します。

## 基本的な使い方

### 1. 音声ファイルを選択する

1. アプリケーションを起動します。
2. メイン画面で「クリックして音声ファイルを選択」をクリックします。
3. ファイルダイアログから音声ファイル（MP3、WAV、M4A、FLAC、AACなど）を選択します。
4. ファイルが選択されると、その名前とパスが表示されます。
5. 必要に応じて「ファイルを変更」ボタンをクリックして別のファイルを選択できます。

### 2. モデルと処理オプションを選択する

1. 文字起こしモデルを選択します：
   - **faster-whisper small**: 高速処理、適度な精度
   - **faster-whisper medium**: より高い精度、適度な処理速度
   - **OpenAI Whisper large-v3-turbo**: 最高精度、より遅い処理速度

2. 必要に応じて「Demucsで音声分離を有効化」オプションを選択または解除します。
   - このオプションを有効にすると、音声ファイルからボーカルトラックが抽出され、より高品質な文字起こし結果が得られます。
   - 処理時間が長くなりますが、特に音楽や背景ノイズを含む音声では精度が向上します。

### 3. 文字起こしを開始する

1. 「文字起こしを開始」ボタンをクリックします。
2. 処理中は進捗バーが表示され、現在の処理段階（音声分離または文字起こし）と推定残り時間が示されます。
3. 処理が完了すると、文字起こし結果が表示されます。

### 4. 文字起こし結果を編集する

1. 文字起こし結果が表示されたテキストエディターで、テキストを直接編集できます。
2. エディターの上部にあるツールバーを使用して、以下の操作が可能です：
   - **元に戻す**: 編集を元に戻します。
   - **やり直し**: 元に戻した編集をやり直します。
   - **段落を整形**: 段落の区切りを整えます。
   - **文字を整形**: 余分なスペースや句読点の前のスペースを削除します。
   - **元の文字起こしに戻す**: 編集前の元の文字起こし結果に戻します。

### 5. 結果をエクスポートする

1. 「エクスポート」セクションで、希望する形式を選択します：
   - **テキストとしてエクスポート (.txt)**: シンプルなテキストファイル
   - **Word文書としてエクスポート (.docx)**: Microsoft Word形式
   - **字幕としてエクスポート (.srt)**: 動画字幕用のSubRip形式（タイムスタンプ付き）
2. 保存先のディレクトリとファイル名を指定します。
3. エクスポートが完了すると、成功メッセージが表示されます。

## トラブルシューティング

### 依存関係のエラー

アプリケーション起動時に「要件を満たしていません」というメッセージが表示される場合：

1. Python 3.9以上がインストールされていることを確認してください。
2. コマンドラインから依存関係を再インストールしてみてください：
   ```bash
   pip install -r src/python/requirements.txt
   ```

### 文字起こし処理のエラー

文字起こし中にエラーが発生する場合：

1. 音声ファイルが破損していないか確認してください。
2. 別の音声ファイル形式を試してください。
3. より小さいモデル（例：faster-whisper small）を選択してみてください。
4. 音声分離を無効にして試してください。

### 音声分離（Demucs）のエラー

音声分離を有効にしたときに「音声分離: 無効」と表示される場合、または以下のようなエラーが発生する場合：

```
Symbol not found: __ZN2at4_ops10zeros_like4callE...
```

これはPyTorchとtorchaudioのバージョン不一致によるエラーです。以下の手順で解決できます：

1. ターミナルを開いて以下のコマンドを実行します：
   ```bash
   pip uninstall torch torchaudio
   pip install torch==2.2.0 torchaudio==2.2.0
   ```

2. アプリケーションを再起動すると、音声分離機能が正常に動作するようになります。

### エクスポートのエラー

エクスポート中にエラーが発生する場合：

1. 保存先のディレクトリに書き込み権限があることを確認してください。
2. 別のファイル形式を試してください。
3. アプリケーションを再起動してみてください。